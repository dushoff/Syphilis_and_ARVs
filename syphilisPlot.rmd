---
title: "Syphils/ARV"
output: html_document
---

```{r pkgs,warning=FALSE,message=FALSE}
library("ggplot2"); theme_set(theme_bw())
scale_colour_discrete <- function(...,palette="Set1") scale_colour_brewer(...,palette=palette)
scale_fill_discrete <- function(...,palette="Set1") scale_fill_brewer(...,palette=palette)
library("gridExtra")
library("plyr")  ## for ldply()
library("dplyr") ## for full_join()
library("reshape2")  ## for melt()
library("GGally")
library("knitr")
## devtools::install_github("lionel-/ggstance")
library("ggstance")
```


```{r index, echo = FALSE}

N <- c(1:9)
S.HIV <- c(1,4,7)
I.HIV <- c(2,5,8)
T.HIV <- c(3,6,9)
S.syph <- c(1:3)
I.syph <- c(4:6)
T.syph <- c(7:9)

```

## All plots

```{r load,echo=FALSE,message=FALSE}

load("syphData.rda")

comp.names <- c("SS", "IS", "TS", "SI", "II", "TI", "ST", "IT", "TT")

syphList <- list()
matNames <- c("highC", "lowC")

tvec <- syph_sim2[,1]

for(i in c(1:2)){
	syphList[[matNames[i]]] <- as.data.frame(syph_sim2[,c(1,seq(from = (i+1), by = 2, length.out = 9))])
	colnames(syphList[[matNames[i]]]) <- c("time",comp.names)
}

syphFrame <- melt(syphList, id.vars = "time")

sumList <- list()

prev_name <- c("N","I.HIV","T.HIV","I.syph","T.syph")

for(m in prev_name){
	sumList[[m]] <- ldply(syphList,
		function(x) data.frame(time = tvec, value = rowSums(x[,get(m)+1])
	))
}

sumFrame <- melt(sumList, id.vars = c("time", ".id"))[,-3]
```


```{r allPlot, fig.width = 10}
print(ggplot(syphFrame, aes(time, value, col = L1)) 
	+ geom_line()
	+ facet_wrap(~variable, scale = "free")
)
```

## Total population

```{r population}

ggplot(subset(sumFrame, L1 %in% c("N")), aes(time, value, col = .id)) +
	geom_line() +
	facet_wrap(~L1, scale = "free")

```

##Total proportion of infected/treated individuals

```{r prevalence,fig.width = 10}

ggplot(subset(sumFrame, L1 %in% prev_name[-1]), aes(time, value, col = .id)) +
	geom_line() +
	facet_wrap(~L1, scale = "free")

```

